// =================================================================================================
// è­¦å‘Šï¼šæ­¤è…³æœ¬æœƒæ¸…ç©ºä¸¦é‡ç½®æ•´å€‹è³‡æ–™åº«ï¼
// åŸ·è¡Œå‰è«‹å‹™å¿…ç¢ºèªæ‚¨äº†è§£å…¶å¾Œæžœã€‚
// å¦‚æžœæ‚¨ç¢ºå¯¦éœ€è¦é‡ç½®è³‡æ–™åº«ï¼Œè«‹æ‰‹å‹•ç§»é™¤ä¸‹æ–¹æ¸…ç†æ•¸æ“šå€å¡Šçš„è¨»è§£ã€‚
// =================================================================================================

const sqlite3 = require('sqlite3').verbose();
const bcrypt = require('bcryptjs');
const path = require('path');
const { db, dbAsync } = require('../database/db');

// å•†å“ç›¸é—œçš„éœæ…‹è³‡æ–™å·²ç§»é™¤ï¼Œæ”¹ç‚ºå‹•æ…‹ç®¡ç†
// å¦‚éœ€è¦å£å‘³å’Œé¡è‰²é¸é …ï¼Œè«‹é€šéŽå¾Œå°ç®¡ç†ç³»çµ±çš„ç”¢å“è®Šé«”åŠŸèƒ½æ·»åŠ 

// ============================================================================
// æ³¨æ„ï¼šéœæ…‹å•†å“æ•¸æ“šå·²ç§»é™¤ï¼Œæ”¹ç‚ºä½¿ç”¨å‹•æ…‹å¾Œå°ç®¡ç†
// å¦‚éœ€æ·»åŠ å•†å“ï¼Œè«‹ä½¿ç”¨å¾Œå°ç®¡ç†ç³»çµ±
// ============================================================================

const products = [];

const seed = async () => {
  try {
    console.log('â³ é–‹å§‹å¡«å……ç¨®å­æ•¸æ“š...');
    await dbAsync.run('BEGIN TRANSACTION');

    // å•†å“æ•¸æ“šå·²å®Œå…¨æ”¹ç‚ºå‹•æ…‹ç®¡ç† - ç§»é™¤éœæ…‹å•†å“é‚è¼¯
    console.log('â„¹ï¸  å•†å“å’Œåˆ†é¡žå·²æ”¹ç‚ºå®Œå…¨å‹•æ…‹ç®¡ç†');
    console.log('ðŸ’¡ è«‹ä½¿ç”¨å¾Œå°ç®¡ç†ç³»çµ±æ·»åŠ å•†å“å’Œåˆ†é¡ž');

    // ... (å…¶ä»–æ•¸æ“šå¡«å……é‚è¼¯ä¿æŒä¸è®Š)

    await dbAsync.run('COMMIT');
    console.log('ðŸŽ‰ æ‰€æœ‰ç¨®å­æ•¸æ“šå¡«å……æˆåŠŸï¼');
  } catch (err) {
    await dbAsync.run('ROLLBACK');
    console.error('âŒ å¡«å……ç¨®å­æ•¸æ“šå¤±æ•—:', err);
    throw err;
  }
};

// å¦‚æžœç›´æŽ¥é‹è¡Œæ­¤æ–‡ä»¶ï¼Œå‰‡åŸ·è¡Œå¡«å……
if (require.main === module) {
  console.log('ä½œç‚ºç¨ç«‹è…³æœ¬é‹è¡Œ: seed-data.js');
  db.serialize(async () => {
    try {
      await seed();
    } catch (err) {
      console.error("Seed failed:", err);
    } finally {
      db.close((err) => {
        if (err) {
          return console.error('é—œé–‰æ•¸æ“šåº«é€£æŽ¥å¤±æ•—:', err.message);
        }
        console.log('âœ… æ•¸æ“šåº«é€£æŽ¥å·²é—œé–‰');
      });
    }
  });
}
